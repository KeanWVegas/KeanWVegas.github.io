<!DOCTYPE>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <title>Choose Your Own Adventure</title>
    <meta name="description" content="A basic JavaScript page to design a game.">
    <meta name="viewport" content="width=device-width"> </head>

<body>
    <main>
        <h1>Choose Your Own Adventure</h1>
        <h2 id="title"></h2>
        <div id="description"></div>

        <div id="choicesDiv">
            <div id="choiceOne"></div>
            <div id="choiceTwo"></div>
            <button onclick="buttonOneClick();" id="buttonOne">Choose 1</button>
            <button onclick="buttonTwoClick();" id="buttonTwo">Choose 2</button>
        </div>
        <div id="endDiv" style="display:none">
            <h2 id="endText"></h2>
            <p/>
            <button id="btnReset" onclick="resetGame()">Reset Game</button>
        </div>
    </main>
    <script>
        //list of instructions
        var instructions = [{
                "id": 1,
                "choices": {
                    "first": 2,
                    "second": 3
                },
                "choiceText": "choose 1",
                "title": "The Adventure Begins",
                "description": "The young knight, in the midst of a fight against dragons, witnesses one capture the princess, and chases after the dragon to its castle. "
            },
            {
                "id": 2,
                "choices": {
                    "first": 3,
                    "second": 4
                },
                "choiceText": "Go Left",
                "title": "The long hallway",
                "description": "You travel down a long forgotten and decrepit building, finding a long hallway that seems to be miles long, with the sound of the roaring dragon coming from the left, and another passage to the left. Do you turn around and find another path, or continue after the sounds?"
            },
            {
                "id": 3,
                "choices": {
                    "first": 2,
                    "second": 5
                },
                "choiceText": "Go Right",
                "title": "The hungry beast",
                "description": "You take the right passage, and come upon another entrance that the beast isn't watching."
            },
            {
                "id": 4,
                "choices": null,
                "choiceText": "Fight dragon head on!",
                "title": "You got cooked like a chicken dinner.",
                "description": "The princess didn't like you anyway.",
                "endText": "Looks like you are dead.  Oh well."
            },
            {
                "id": 5,
                "choices": null,
                "choiceText": "Sneak up on dragon!",
                "title": "Ending",
                "description": "The beast turned out to be oblivious, and you slayed it with ease, saving the princess.",
                "endText": "Congratulations!"
            }
        ];

        //first choice button click event
        function buttonOneClick() {
            //get the button element
            var btn = document.getElementById("buttonOne");
            var id = btn.selectId;

            //advance to the step stored in the button attributes
            nextStep(id);
        }

        //first choice button click event
        function buttonTwoClick() {
            //get the button element
            var btn = document.getElementById("buttonTwo");
            var id = btn.selectId;

            //advance to the step stored in the button attributes
            nextStep(id);
        }

        //reset the game to its initial state
        function resetGame() {
            //switch div visibility
            var elem = document.getElementById("endDiv");
            elem.style.display = "none";
            var elem2 = document.getElementById("choicesDiv");
            elem2.style.display = "block";

            //move to the first step
            nextStep(1);
        }

        //updates the screen to show the current description and choices
        //requires the id of the new set of instructions
        function nextStep(id) {
            //first we need to get the new item from the list of instructions
            var instruction = getItem(id);

            //then we need to update the screen with the title and description
            updateElement('title', instruction.title);
            updateElement('description', instruction.description);

            //check that the instruction has choices - if not, this is an end state
            if (instruction.choices !== null) {
                //get the two choice options
                var choice1 = getItem(instruction.choices.first);
                var choice2 = getItem(instruction.choices.second);

                //update the choice text and buttons
                updateElement('choiceOne', choice1.choiceText);
                updateElement('choiceTwo', choice2.choiceText);
                updateButton('buttonOne', choice1.id);
                updateButton('buttonTwo', choice2.id);
            } else {
                //this is an end state

                //make the ending div visible
                var elem = document.getElementById("endDiv");
                elem.style.display = "block";

                //set the end text
                var endText = document.getElementById("endText");
                endText.innerText = instruction.endText;

                //hide the choice options, since there can't be any choices in an end state
                var elem2 = document.getElementById("choicesDiv");
                elem2.style.display = "none";
            }
        }

        //retrieve an instruction from the list with matching id. If no match found, returns undefined
        function getItem(id) {
            for (var i = 0; i < instructions.length; i++) {
                if (instructions[i]["id"] == id) {
                    return instructions[i];
                }
            }
            return undefined;
        }

        //update the element text with the given ID and value
        function updateElement(id, value) {
            var element = document.getElementById(id);
            element.innerText = value;
        }

        //update the button selectId with the given ID and value
        function updateButton(id, value) {
            var element = document.getElementById(id);
            element.selectId = value;
        }

        //start the game
        nextStep(1);

    </script>
</body>
<footer>
</footer>

</html>
